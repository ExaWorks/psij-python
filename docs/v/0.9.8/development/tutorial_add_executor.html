


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Adding an executor &#8212; PSI/J</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/cloud.css" />
    <link rel="stylesheet" type="text/css" href="../_static/extras.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
        <link rel="stylesheet" href="/psij-python/theme-4.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&family=Open+Sans&family=Saira:wght@300;400&family=Nunito+Sans:wght@300;400" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue-router/2.0.3/vue-router.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-migrate-3.4.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="/psij-python/style.css?id=2">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/base16/tender.min.css">
    <script src="https://kit.fontawesome.com/0f2ef02e2b.js" crossorigin="anonymous"></script>
    <script src="/psij-python/versions.js"></script>
    <script src="/psij-python/versioning.js"></script>
    
    
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/extras.js"></script>

    
    
     
        <script src="../_static/jquery.cookie.js"></script>
    

    
     
        <script src="../_static/cloud.base.js"></script>
    

    
     
        <script src="../_static/cloud.js"></script>
    


    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Architecture" href="programming.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <v-app id="psij-app" class="psij-docs">
                <v-app-bar elevation="4" height="48pt" fixed elevate-on-scroll width="100%">
            <v-tabs v-model="maintabs">
                <v-tab key="index"><a href="/psij-python/index.html"><div class="psij-font logo">PSI/J</div></a></v-tab>
                <v-tab key="install"><a href="/psij-python/install.html">Install</a></v-tab>
                <v-tab key="docs"><a href="/psij-python/docs">Documentation</a></v-tab>
                <v-tab key="resources"><a href="/psij-python/resources.html">Resources</a></v-tab>
                <v-tab key="about"><a href="/psij-python/about.html">About</a></v-tab>
            </v-tabs>
   
            <div class="slack-link navbar-link">
                <a href="https://join.slack.com/t/exaworks/shared_invite/zt-gttapi1i-GSaiHd8Q0h7uKyZnIqAUwQ"
                    target="_blank"><i class="fab fa-slack"></i></a>&nbsp;&nbsp;
            </div>
            <div class="gh-link navbar-link">
                <a href="https://github.com/exaworks" target="_blank"><i class="fab fa-github"></i></a>
            </div>
        </v-app-bar>

        <div id="top-spacer"></div>
        

    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="programming.html" title="Architecture"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">PSI/J</a>            <div id="version-selector">
                <v-select :items="getSortedVersionLabels()" @change="setVersion" v-model="version"></v-select>
            </div> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Developer Docs</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Adding an executor</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="adding-an-executor">
<h1>Adding an executor<a class="headerlink" href="#adding-an-executor" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will write an executor for PBSPro using the PSI/J batch scheduler
executor interface.</p>
<p>It should be useful when writing an executor for any HPC style scheduler
that looks like SLURM or PBSPro.</p>
<div class="section" id="what-is-an-executor-and-why-might-you-want-to-add-one">
<h2>What Is an Executor and Why Might You Want to Add One?<a class="headerlink" href="#what-is-an-executor-and-why-might-you-want-to-add-one" title="Permalink to this headline">¶</a></h2>
<p>PSI/J provides a common interface for obtaining allocations on compute resources. Usually, those compute resources will already have a batch scheduler in place (for example, SLURM).</p>
<p>A PSI/J executor is the code that tells the core of PSI/J how to interact with a batch scheduler so that it can provide a common interface to applications.</p>
<p>A PSI/J executor needs to implement the abstract methods defined on the <a class="reference internal" href="../.generated/index.html#psij.job_executor.JobExecutor" title="psij.job_executor.JobExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">psij.job_executor.JobExecutor</span></code></a> base class.
The documentation for that class has reference material for each of the methods that won’t be repeated here.</p>
<p>For batch scheduler systems, the <a class="reference internal" href="../.generated/tree.html#psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor" title="psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BatchSchedulerExecutor</span></code></a> subclass provides further useful structure to help implement JobExecutor.
This tutorial will focus on using BatchSchedulerExecutor as a base, rather than implementing JobExecutor directly.</p>
<p>The batch scheduler executor is based on a model where interactions with a local resource manager happen via command line invocations.
For example, with PBS <cite>qsub</cite> and <cite>qstat</cite> commands are used to submit a request and to see status.</p>
<p>To use BatchSchedulerExecutor for a new local resource manager that uses this command line interface, subclass BatchSchedulerExecutor and add in code that understands how to form the command lines necessary to submit a request for an allocation and to get allocation status. This tutorial will do that for PBSPro.</p>
</div>
<div class="section" id="id1">
<h2>Adding an Executor<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>First set up a directory structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">project</span><span class="o">/</span>
<span class="n">cd</span> <span class="n">project</span><span class="o">/</span>
<span class="n">mkdir</span> <span class="n">psijpbs</span>
<span class="n">mkdir</span> <span class="n">psij</span><span class="o">-</span><span class="n">descriptors</span>
</pre></div>
</div>
<p>We’re going to create three source files in this directory structure:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">psijpbs/pbspro.py</span></code> - This will contain the bulk of the code.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">psijpbs/pbspro.mustace</span></code> - This will contain a template for a PBS Pro job submission file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">psij-descriptors/pbspro_descriptor.py</span></code> - This file tells the PSI/J core what this package implements.</p></li>
</ul>
<p>Prerequisites:</p>
<ul class="simple">
<li><p>You have the psij-python package installed and are able to run whatever basic verification you think is necessary.</p></li>
<li><p>You are able to submit to PBS Pro on a local system.</p></li>
</ul>
<p>First, we’ll build a skeleton that won’t work, and see that it doesn’t work in the test suite. Then we’ll build up to the full functionality.</p>
</div>
<div class="section" id="a-not-implemented-stub">
<h2>A Not-implemented Stub<a class="headerlink" href="#a-not-implemented-stub" title="Permalink to this headline">¶</a></h2>
<p>Add the project directory to the Python path directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export PYTHONPATH=$(pwd):$PYTHONPATH
</pre></div>
</div>
<p>Create a simple BatchSchedulerExecutor subclass that does nothing new in <cite>psijpbs/pbspro.py</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">psij.executors.batch.batch_scheduler_executor</span> <span class="kn">import</span> <span class="n">BatchSchedulerExecutor</span>

<span class="k">class</span> <span class="nc">PBSProJobExecutor</span><span class="p">(</span><span class="n">BatchSchedulerExecutor</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>and create a descriptor file to tell PSI/J about this, <code class="docutils literal notranslate"><span class="pre">psij-descriptors/pbspro.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">packaging.version</span> <span class="kn">import</span> <span class="n">Version</span>

<span class="kn">from</span> <span class="nn">psij._descriptor</span> <span class="kn">import</span> <span class="n">_Descriptor</span>

<span class="n">__PSI_J_EXECUTORS__</span> <span class="o">=</span> <span class="p">[</span><span class="n">_Descriptor</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;pbspro&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">Version</span><span class="p">(</span><span class="s1">&#39;0.0.1&#39;</span><span class="p">),</span>
                                   <span class="bp">cls</span><span class="o">=</span><span class="s1">&#39;psijpbs.pbspro.PBSProJobExecutor&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>Now, run the test suite. It should fail with an error reporting that the resource manager specific methods of BatchSchedulerExecutor have not been implemented:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PYTHONPATH=$PWD/src:../wheverever/project/ pytest &#39;tests/test_executor.py::test_simple_job&#39; --executors=pbspro
TypeError: Can&#39;t instantiate abstract class PBSProJobExecutor with abstract methods generate_submit_script, get_cancel_command, get_status_command, get_submit_command, job_id_from_submit_output, parse_status_output, process_cancel_command_output
</pre></div>
</div>
<p>That error message tells us what we need to implement. There are three broad pieces of functionality:</p>
<ul>
<li><p>Submitting a job:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">generate_submit_script</span>
<span class="n">get_submit_command</span>
<span class="n">job_id_from_submit_output</span>
</pre></div>
</div>
</li>
<li><p>Requesting job status:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">get_status_command</span>
<span class="n">parse_status_output</span>
</pre></div>
</div>
</li>
<li><p>Cancelling a job:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">get_cancel_command</span>
<span class="n">process_cancel_command_output</span>
</pre></div>
</div>
</li>
</ul>
<p>Let’s implement all of these with stubs that return a NotImplementedError that we will then flesh out:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PBSProJobExecutor</span><span class="p">(</span><span class="n">BatchSchedulerExecutor</span><span class="p">):</span>

 <span class="k">def</span> <span class="nf">generate_submit_script</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">NotImplementedError</span>

  <span class="k">def</span> <span class="nf">get_submit_command</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">NotImplementedError</span>

  <span class="k">def</span> <span class="nf">job_id_from_submit_output</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">NotImplementedError</span>

  <span class="k">def</span> <span class="nf">get_cancel_command</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">NotImplementedError</span>

  <span class="k">def</span> <span class="nf">process_cancel_command_output</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">NotImplementedError</span>

  <span class="k">def</span> <span class="nf">get_status_command</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">NotImplementedError</span>

  <span class="k">def</span> <span class="nf">parse_status_output</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>
</div>
<p>Now running the same pytest command will give a different error further along into attempting to submit a job:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span>       <span class="k">assert</span> <span class="n">config</span>
<span class="n">E</span>       <span class="ne">AssertionError</span>
</pre></div>
</div>
<p>This default BatchSchedulerExecutor code needs a configuration object and none was supplied.</p>
<p>A configuration object can contain configuration specific to this particular executor. For now we are not going to specify a custom configuration object and instead will reuse
the BatchSchedulerExecutorConfig supplied by the PSI/J core.</p>
<p>Define a new __init__ method that will define a default configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">psij.executors.batch.batch_scheduler_executor</span> <span class="kn">import</span> <span class="n">BatchSchedulerExecutorConfig</span>

<span class="o">...</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
          <span class="n">config</span> <span class="o">=</span> <span class="n">BatchSchedulerExecutorConfig</span><span class="p">()</span>
      <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
<p>The URL parameter can be ignored entirely for batch scheduler systems.</p>
<p>Running pytest again, we get as far as seeing PSI/J is trying to do submit-related stuff:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="k">def</span> <span class="nf">generate_submit_script</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="o">&gt;</span>       <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<span class="n">E</span>       <span class="ne">NotImplementedError</span>

<span class="o">../</span><span class="n">tutorial</span><span class="o">-</span><span class="n">play</span><span class="o">/</span><span class="n">psijpbs</span><span class="o">/</span><span class="n">pbspro</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span> <span class="ne">NotImplementedError</span>
</pre></div>
</div>
</div>
<div class="section" id="implementing-job-submission">
<h2>Implementing Job Submission<a class="headerlink" href="#implementing-job-submission" title="Permalink to this headline">¶</a></h2>
<p>To implement submission, we need to implement three methods:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../.generated/tree.html#psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.generate_submit_script" title="psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.generate_submit_script"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.generate_submit_script()</span></code></a></p></li>
<li><p><a class="reference internal" href="../.generated/tree.html#psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.get_submit_command" title="psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.get_submit_command"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.get_submit_command()</span></code></a></p></li>
<li><p><a class="reference internal" href="../.generated/tree.html#psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.job_id_from_submit_output" title="psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.job_id_from_submit_output"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.job_id_from_submit_output()</span></code></a></p></li>
</ul>
<p>You can read the docstrings for each of these methods for more information, but briefly the submission process is:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">generate_submit_script</span></code> generates a submit script specific to the batch scheduler.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_submit_command</span></code> returns the command line necessary to submit that script to the batch scheduler.</p></li>
</ol>
<p>The output of that command should be interpreted by <code class="docutils literal notranslate"><span class="pre">job_id_from_submit_output</span></code> to extract a batch scheduler specific job ID,
which can be used later when cancelling a job or getting job status.</p>
<p>In line with other PSI/J executors, we’re going to delegate script generation to a template based helper. So add a line to initialize a <a class="reference internal" href="../.generated/tree.html#psij.executors.batch.script_generator.TemplatedScriptGenerator" title="psij.executors.batch.script_generator.TemplatedScriptGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TemplatedScriptGenerator</span></code></a> in the
executor initializer, pointing at a (as yet non-existent) template file, and replace <code class="docutils literal notranslate"><span class="pre">generate_submit_script</span></code> with a delegated call to <cite>TemplatedScriptGenerator</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">psij</span> <span class="kn">import</span> <span class="n">Job</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">TextIO</span>
<span class="kn">from</span> <span class="nn">psij.executors.batch.script_generator</span> <span class="kn">import</span> <span class="n">TemplatedScriptGenerator</span>


<span class="k">class</span> <span class="nc">PBSProJobExecutor</span><span class="p">(</span><span class="n">BatchSchedulerExecutor</span><span class="p">):</span>

<span class="o">...</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PBSProExecutorConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">BatchSchedulerExecutorConfig</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">TemplatedScriptGenerator</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;pbspro.mustache&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_submit_script</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job</span><span class="p">:</span> <span class="n">Job</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">],</span>
                               <span class="n">submit_file</span><span class="p">:</span> <span class="n">TextIO</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">generate_submit_script</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">submit_file</span><span class="p">)</span>
</pre></div>
</div>
<p>Now the test will fail with an error like this, because that template doesn’t exist:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">E</span>       <span class="ne">FileNotFoundError</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">2</span><span class="p">]</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span><span class="p">:</span> <span class="s1">&#39;/home/you/project/psijpbs/pbspro.mustache&#39;</span>
</pre></div>
</div>
<p>Here is a very simple template for PBS, lacking a lot of features. A full template should use all of the fields in the supplied <a class="reference internal" href="../.generated/tree.html#psij.Job" title="psij.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">psij.Job</span></code></a> object, as well as any executor-specific parameters supplied in the <code class="docutils literal notranslate"><span class="pre">config</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">__init__</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash

{{#job.name}}
#PBS -N=&quot;{{.}}&quot;
{{/job.name}}

{{#job.spec.inherit_environment}}
#PBS -V
{{/job.spec.inherit_environment}}

{{#job.spec.attributes}}
  {{#duration}}
#PBS -l walltime={{.}}
  {{/duration}}
  {{#custom_attributes.pbs}}
#PBS --{{key}}=&quot;{{value}}&quot;
  {{/custom_attributes.pbs}}

{{/job.spec.attributes}}

#PBS -e /dev/null
#PBS -o /dev/null

{{#job.spec.directory}}
cd &quot;{{.}}&quot;
{{/job.spec.directory}}

exec &amp;&gt;&gt; &quot;{{psij.script_dir}}/$PBS_JOBID.out&quot;

{{#psij.launch_command}}{{.}} {{/psij.launch_command}}

{{!we redirect to a file tied to the native ID so that we can reach the file with attach().}}
echo &quot;$?&quot; &gt; &quot;{{psij.script_dir}}/$PBS_JOBID.ec&quot;
</pre></div>
</div>
<p>Next, the test will fail because <code class="docutils literal notranslate"><span class="pre">get_submit_command</span></code> is missing. This method is going to give a command line to run to submit the tempate-generated submit file. In PBS, that submission happens by running a command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">qsub</span> <span class="n">c</span><span class="o">.</span><span class="n">submit</span>
<span class="mf">2152.</span><span class="n">edtb</span><span class="o">-</span><span class="mf">01.</span><span class="n">mcp</span><span class="o">.</span><span class="n">alcf</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span>
</pre></div>
</div>
<p>Here’s an implementation of <code class="docutils literal notranslate"><span class="pre">get_submit_command</span></code> that will make such a command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="k">def</span> <span class="nf">get_submit_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job</span><span class="p">:</span> <span class="n">Job</span><span class="p">,</span> <span class="n">submit_file_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;qsub&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">submit_file_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">())]</span>
</pre></div>
</div>
<p>The implementation so far is enough to get jobs to run in PBS, but not enough for PSI/J to make sense of what it has submitted.</p>
<p>The final step in submission is implementing <code class="docutils literal notranslate"><span class="pre">job_id_from_submit_output</span></code>. This interprets the output of the submit command to find the batch schedulers’s job ID for the newly created job.</p>
<p>In the PBS Pro case, as shown in the example above, that is pretty straightforward. The entire output is the job ID:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">job_id_from_submit_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</pre></div>
</div>
<p>That’s enough to get jobs submitted using PSI/J, but not enough to run the test suite. Instead, the test suite will appear to hang, because the PSI/J core code gets a bit upset by status monitoring methods raising a NotImplementedError.</p>
</div>
<div class="section" id="implementing-status">
<h2>Implementing Status<a class="headerlink" href="#implementing-status" title="Permalink to this headline">¶</a></h2>
<p>PSI/J needs to ask the batch scheduler for the status of jobs that it has submitted. This can be done with <code class="docutils literal notranslate"><span class="pre">BatchSchedulerExecutor</span></code> by overriding these two methods, which we stubbed out as not-implemented earlier on:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../.generated/tree.html#psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.get_status_command" title="psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.get_status_command"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BatchSchedulerExecutor.get_status_command()</span></code></a> - Like <code class="docutils literal notranslate"><span class="pre">get_submit_command</span></code>, this should return a batch scheduler-specific command line, this time to output job status.</p></li>
<li><p><a class="reference internal" href="../.generated/tree.html#psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.parse_status_output" title="psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.parse_status_output"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BatchSchedulerExecutor.parse_status_output()</span></code></a> - This will interpret the output of the above status command, a bit like <code class="docutils literal notranslate"><span class="pre">job_id_from_submit_output</span></code>.</p></li>
</ul>
<p>Here’s an implementation for <code class="docutils literal notranslate"><span class="pre">get_status_command</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Collection</span>

<span class="k">def</span> <span class="nf">get_status_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">native_ids</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">ids</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">native_ids</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;qstat&#39;</span><span class="p">,</span>  <span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="s1">&#39;-F&#39;</span><span class="p">,</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="s1">&#39;-x&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">native_ids</span><span class="p">)</span>
</pre></div>
</div>
<p>This constructs a command line which looks something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qstat</span> <span class="o">-</span><span class="n">f</span> <span class="o">-</span><span class="n">F</span> <span class="n">json</span> <span class="o">-</span><span class="n">x</span> <span class="mf">2154.</span><span class="n">edtb</span><span class="o">-</span><span class="mf">01.</span><span class="n">mcp</span><span class="o">.</span><span class="n">alcf</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span>
</pre></div>
</div>
<p>The parameters change the default behavior of <code class="docutils literal notranslate"><span class="pre">qstat</span></code> to something more useful for parsing: <code class="docutils literal notranslate"><span class="pre">-f</span></code> asks for full output, with <cite>-x</cite> including information for completed jobs (which is normally suppressed) and <code class="docutils literal notranslate"><span class="pre">-F</span> <span class="pre">json</span></code> asking for the output to be formatted as JSON (rather than a default text tabular view).</p>
<p>This JSON output, which is passed to <code class="docutils literal notranslate"><span class="pre">parse_status_output</span></code> looks something like this (with a lot of detail removed):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;pbs_version&quot;</span><span class="p">:</span><span class="s2">&quot;2022.0.0.20211103141832&quot;</span><span class="p">,</span>
   <span class="s2">&quot;Jobs&quot;</span><span class="p">:{</span>
       <span class="s2">&quot;2154.edtb-01.mcp.alcf.anl.gov&quot;</span><span class="p">:{</span>
           <span class="s2">&quot;job_state&quot;</span><span class="p">:</span><span class="s2">&quot;F&quot;</span><span class="p">,</span>
           <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Job run at Mon Jan 24 at 08:39 on (edtb-01[0]:ncpus=1) and finished&quot;</span><span class="p">,</span>
           <span class="s2">&quot;Exit_status&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
       <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is an implementation for <code class="docutils literal notranslate"><span class="pre">parse_status_output</span></code>, as well as a helper dictionary <code class="docutils literal notranslate"><span class="pre">_STATE_MAP</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">psij</span> <span class="kn">import</span> <span class="n">JobState</span><span class="p">,</span> <span class="n">JobStatus</span>
<span class="kn">from</span> <span class="nn">psij.executors.batch.batch_scheduler_executor</span> <span class="kn">import</span> <span class="n">check_status_exit_code</span>

<span class="n">_STATE_MAP</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="n">JobState</span><span class="o">.</span><span class="n">QUEUED</span><span class="p">,</span>
    <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="n">JobState</span><span class="o">.</span><span class="n">ACTIVE</span><span class="p">,</span>
    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="n">JobState</span><span class="o">.</span><span class="n">COMPLETED</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">PBSProJobExecutor</span><span class="p">:</span> <span class="o">...</span>

    <span class="k">def</span> <span class="nf">parse_status_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exit_code</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">JobStatus</span><span class="p">]:</span>
        <span class="n">check_status_exit_code</span><span class="p">(</span><span class="n">_QSTAT_COMMAND</span><span class="p">,</span> <span class="n">exit_code</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">report</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="n">jobs</span> <span class="o">=</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;Jobs&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">native_id</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
            <span class="n">native_state</span> <span class="o">=</span> <span class="n">jobs</span><span class="p">[</span><span class="n">native_id</span><span class="p">][</span><span class="s2">&quot;job_state&quot;</span><span class="p">]</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">_STATE_MAP</span><span class="p">(</span><span class="n">native_state</span><span class="p">)</span>

            <span class="n">msg</span> <span class="o">=</span> <span class="n">jobs</span><span class="p">[</span><span class="n">native_id</span><span class="p">][</span><span class="s2">&quot;comment&quot;</span><span class="p">]</span>
            <span class="n">r</span><span class="p">[</span><span class="n">native_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">JobStatus</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">r</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">parse_status_output</span></code> is given both the stdout and the exit code of <code class="docutils literal notranslate"><span class="pre">qstat</span></code> and must either transcribe that into a dictionary of <a class="reference internal" href="../.generated/tree.html#psij.JobStatus" title="psij.JobStatus"><code class="xref py py-class docutils literal notranslate"><span class="pre">psij.JobStatus</span></code></a> objects describing the state of each job, or raise an exception.</p>
<p>This implementation uses a helper, <a class="reference internal" href="../.generated/tree.html#psij.executors.batch.batch_scheduler_executor.check_status_exit_code" title="psij.executors.batch.batch_scheduler_executor.check_status_exit_code"><code class="xref py py-func docutils literal notranslate"><span class="pre">psij.executors.batch.batch_scheduler_executor.check_status_exit_code()</span></code></a>, which will raise an exception if <code class="docutils literal notranslate"><span class="pre">qstat</span></code> exited with a non-zero exit code. Then, it assumes that the <code class="docutils literal notranslate"><span class="pre">qstat</span></code> output is JSON and deserialises, and for each job in the JSON, it uses two fields to create a <code class="docutils literal notranslate"><span class="pre">psij.JobStatus</span></code> object: a human readable message is taken from the PBS <code class="docutils literal notranslate"><span class="pre">comment</span></code> field, and a machine readable status is converted from a single letter PBS status (such as F for finished, or Q for queued) into a PSI/J <a class="reference internal" href="../.generated/tree.html#psij.JobState" title="psij.JobState"><code class="xref py py-class docutils literal notranslate"><span class="pre">psij.JobState</span></code></a> via the <code class="docutils literal notranslate"><span class="pre">_STATE_MAP</span></code> dictionary.</p>
<p>With these status methods in place, the <code class="docutils literal notranslate"><span class="pre">pytest</span></code> command from before should execute to completion.</p>
<p>We still haven’t implemented the cancel methods, though. That will be revealed by running a broader range of tests:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PYTHONPATH=$PWD/src:$PYTHONPATH pytest &#39;tests&#39; --executors=pbspro
</pre></div>
</div>
<p>which should give this error (amongst others—this commandline formation is ugly and I’d like it to work more along the lines of <cite>make test</cite>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FAILED</span> <span class="n">tests</span><span class="o">/</span><span class="n">test_executor</span><span class="o">.</span><span class="n">py</span><span class="p">::</span><span class="n">test_cancel</span><span class="p">[</span><span class="n">pbspro</span><span class="p">]</span> <span class="o">-</span> <span class="ne">NotImplementedError</span>
</pre></div>
</div>
</div>
<div class="section" id="implementing-cancel">
<h2>Implementing Cancel<a class="headerlink" href="#implementing-cancel" title="Permalink to this headline">¶</a></h2>
<p>The two methods to implement for cancellation follow the same pattern as for submission and status:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../.generated/tree.html#psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.get_cancel_command" title="psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.get_cancel_command"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BatchSchedulerExecutor.get_cancel_command()</span></code></a> - This should form a command for cancelling a job.</p></li>
<li><p><a class="reference internal" href="../.generated/tree.html#psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.process_cancel_command_output" title="psij.executors.batch.batch_scheduler_executor.BatchSchedulerExecutor.process_cancel_command_output"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BatchSchedulerExecutor.process_cancel_command_output()</span></code></a> - This should interpret the output from the cancel command.</p></li>
</ul>
<p>It looks like you don’t actually need to implement <cite>process_cancel_command_output</cite> beyond the stub we already have, to make the abstract class mechanism happy. Maybe that’s something that should change in psi/j?</p>
<p>Here’s an implementation of <cite>get_cancel_command</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_cancel_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">native_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;qdel&#39;</span><span class="p">,</span> <span class="n">native_id</span><span class="p">]</span>
</pre></div>
</div>
<p>That’s enough to tell PBS Pro how to cancel a job, but it isn’t enough for PSI/J to know that a job was actually cancelled: the JobState from <cite>parse_status_output</cite> will still return a state of COMPLETED, when we actually want CANCELED. That’s because the existing job marks a job as COMPLETED whenever it reaches PBS Pro state <cite>F</cite>—no matter how the job finished.</p>
<p>So here’s an updated <cite>parse_status_output</cite> which checks the <code class="docutils literal notranslate"><span class="pre">Exit_status</span></code> field in the qstat JSON to see if it exited with status code 265—that means that the job was killed with signal 9. and if so, marks the job as CANCELED instead of COMPLETED:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">parse_status_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exit_code</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">JobStatus</span><span class="p">]:</span>
    <span class="n">check_status_exit_code</span><span class="p">(</span><span class="s1">&#39;qstat&#39;</span><span class="p">,</span> <span class="n">exit_code</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">report</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
    <span class="n">jobs</span> <span class="o">=</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;Jobs&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">native_id</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
        <span class="n">job_report</span> <span class="o">=</span> <span class="n">jobs</span><span class="p">[</span><span class="n">native_id</span><span class="p">]</span>
        <span class="n">native_state</span> <span class="o">=</span> <span class="n">job_report</span><span class="p">[</span><span class="s2">&quot;job_state&quot;</span><span class="p">]</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">_STATE_MAP</span><span class="p">[</span><span class="n">native_state</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">JobState</span><span class="o">.</span><span class="n">COMPLETED</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Exit_status&#39;</span> <span class="ow">in</span> <span class="n">job_report</span> <span class="ow">and</span> <span class="n">job_report</span><span class="p">[</span><span class="s1">&#39;Exit_status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">265</span><span class="p">:</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">JobState</span><span class="o">.</span><span class="n">CANCELED</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="n">job_report</span><span class="p">[</span><span class="s2">&quot;comment&quot;</span><span class="p">]</span>
        <span class="n">r</span><span class="p">[</span><span class="n">native_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">JobStatus</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r</span>
</pre></div>
</div>
<p>This isn’t necessarily the right thing to do: some PBS installs will use 128+9 = 137 to represent this instead of 256 + 9 = 265, according to the PBS documentation.</p>
</div>
<div class="section" id="what-s-missing">
<h2>What’s Missing?<a class="headerlink" href="#what-s-missing" title="Permalink to this headline">¶</a></h2>
<p>The biggest thing that was omitted was in the mustache template. A <a class="reference internal" href="../.generated/tree.html#psij.Job" title="psij.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">psij.Job</span></code></a> object contains lots of options which could be transcribed into the template (otherwise they will be ignored). Have a look at the docstrings for <code class="docutils literal notranslate"><span class="pre">Job</span></code> and at other templates in the PSI/J source code for examples.</p>
<p>The _STATE_MAP given here is also not exhaustive: if PBS Pro qstat returns a different state for a job than what is in it, this will break. So make sure you deal with all the states of your batch scheduler, not just a few that seem obvious.</p>
</div>
<div class="section" id="how-to-distribute-your-executor">
<h2>How to Distribute Your Executor<a class="headerlink" href="#how-to-distribute-your-executor" title="Permalink to this headline">¶</a></h2>
<p>If you want to share your executor with others:</p>
<ol class="arabic simple">
<li><p>You can make a Python package and distribute that as an add-on without needing to interact with the PSI/J project.</p></li>
<li><p>You can make a pull request against the PSI/J repo.</p></li>
</ol>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div class="sphinx-toc sphinxglobaltoc">
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Docs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="programming.html">Architecture</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Adding an executor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-an-executor-and-why-might-you-want-to-add-one">What Is an Executor and Why Might You Want to Add One?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Adding an Executor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-not-implemented-stub">A Not-implemented Stub</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementing-job-submission">Implementing Job Submission</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementing-status">Implementing Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementing-cancel">Implementing Cancel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-s-missing">What’s Missing?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-distribute-your-executor">How to Distribute Your Executor</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="programming.html"
                          title="Previous page">&larr; Architecture</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/development/tutorial_add_executor.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="application/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
    
    

      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="programming.html" title="Architecture"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">PSI/J</a>            <div id="version-selector">
                <v-select :items="getSortedVersionLabels()" @change="setVersion" v-model="version"></v-select>
            </div> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" >Developer Docs</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Adding an executor</a></li> 
      </ul>
    </div>
    </div>

        
    <div class="footer" role="contentinfo">
        &#169; Copyright The ExaWorks Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
    <!-- cloud_sptheme 1.4 -->
        
                <v-footer>
            <v-card flat tile class="lighten-1 text-center"
                style="margin: auto; padding: 2em 0; background-color: #f5f5f5 !important;">
                <v-card-text>
                    &copy;2021-<script type="application/javascript">document.write(new Date().getFullYear());</script> - <a href="https://exaworks.org">The ExaWorks Project</a>
                </v-card-text>

                <v-row justify="center">
                    <v-col justify="center">
                        <img height="36pt" src="https://exaworks.org/images/llnl.png">
                    </v-col>
                    <v-col justify="center">
                        <img height="36pt" src="https://exaworks.org/images/anl-200.png">
                    </v-col>
                    <v-col justify="center">
                        <img height="36pt" src="https://exaworks.org/images/bnl.png">
                    </v-col>
                    <v-col justify="center">
                        <img height="30pt" src="https://exaworks.org/images/ornl.png"
                            style="vertical-align: bottom; margin-top: 0.3em">
                    </v-col>
                </v-row>
                <v-row justify="center">
                    <v-col class="text-end">
                        <img height="20pt"
                            src="https://science.osti.gov/-/media/_/images/about/resources/logos/png/high-res/RGB_Color-Seal_Green-Mark_SC_Horizontal.png"
                            style="vertical-align: middle">
                    </v-col>
                    <v-col class="text-start">
                        <span class="psij-font">PSI/J</span> is funded by the U.S. Department of Energy
                    </v-col>
                    <v-col class="text-end">
                        <img height="40pt" src="https://www.ecpannualmeeting.com/images/ecp-horizontal.png">
                    </v-col>
                    <v-col class="text-start">
                        <span class="psij-font">PSI/J</span> is part of the Exascale Computing Project
                    </v-col>
                </v-row>
            </v-card>
        </v-footer>
    </v-app>
    
    
    
    
    <script>
        /* need this to avoid vue thinking some code block that
           happens to match some of its syntax is a template that
           needs to be processed */
        $("div.highlight > pre").each(function() {
            $(this).attr("v-pre", "");
        });
        v = new Vue({
            el: '#psij-app',
            vuetify: new Vuetify(),
            data: {
                maintabs: 2,
                version: getCurrentVersion()
            },
            methods: {
                getSortedVersionLabels: getSortedVersionLabels,
                setVersion: setVersion,
                getMainDocsPage: getMainDocsPage,
                isDocsPage: isDocsPage
            }
        });

        hljs.highlightAll();
    </script>
    


  </body>
</html>